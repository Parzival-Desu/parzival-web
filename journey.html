<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My Journey ‚Äî Parzival Takei</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:"Poppins",sans-serif}
  html,body{height:100%}
  body{
    height:100vh;overflow:hidden;
    background:linear-gradient(to bottom,#ffe4ec 0%,#e6f3ff 50%,#ffffff 100%);
    transition:background 0.8s ease;
  }

  /* INTRO SCREEN */
  #intro{
    position:fixed;
    inset:0;
    background:#000;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:36px;
    font-weight:600;
    opacity:1;
    z-index:999;
    transition:opacity 1s ease;
  }

  /* Clouds */
  .cloud{position:absolute;background:#fff;border-radius:50%;z-index:0;opacity:.95}
  .ground{position:absolute;bottom:0;height:100px;width:4000px;background:#fbeaea;z-index:2}

  .scene{
    position:absolute;
    left:0;
    bottom:100px;
    height:100%;
    width:4000px;
    display:flex;
    align-items:flex-end;
    gap:0 300px;
    padding-left:220px;
    transition:left .12s linear;
    z-index:3;
    opacity:0;
    transition:opacity 1s ease;
  }

  .player{position:fixed;bottom:110px;left:120px;z-index:6;pointer-events:none;transition:left .06s linear, opacity 1s ease;opacity:0}
  .player-box{width:60px;height:60px;background:#b3e5fc;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,.18);position:relative}
  .player-box::before,.player-box::after{content:"";position:absolute;top:22px;width:8px;height:8px;background:#333;border-radius:50%}
  .player-box::before{left:14px}.player-box::after{right:14px}
  .player.walking .player-box{animation:walk .24s infinite alternate}
  @keyframes walk{from{transform:translateY(0)}to{transform:translateY(-6px)}}
  .player small{display:block;text-align:center;margin-top:6px;color:#444;font-size:12px}

  .checkpoint{
    position:relative;
    width:140px;height:100px;background:#f8f8ff;border-radius:10px;
    display:flex;justify-content:center;align-items:flex-end;
    box-shadow:0 6px 16px rgba(0,0,0,.12);z-index:4;
  }
  .roof{position:absolute;top:-40px;width:0;height:0;border-left:70px solid transparent;border-right:70px solid transparent;border-bottom:40px solid #ffd6da}
  .checkpoint .dialog{position:absolute;top:-120px;left:50%;transform:translateX(-50%);width:260px;background:rgba(255,255,255,.98);padding:10px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.12);opacity:0;pointer-events:none;transition:opacity .22s ease;color:#333;font-size:14px;line-height:1.4}
  .checkpoint.active .dialog{opacity:1}

  .progress-bar{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;width:70%;height:10px;background:#eee;border-radius:8px;z-index:9;opacity:0;transition:opacity 1s ease}
  .progress{height:100%;width:0;background:linear-gradient(90deg,#ffb6c1,#b3e5fc);border-radius:8px;transition:width .25s ease}

  .controls{position:fixed;right:20px;bottom:22px;display:flex;flex-direction:column;gap:8px;z-index:9;opacity:0;transition:opacity 1s ease}
  .controls button{background:linear-gradient(90deg,#ffb6c1,#fad0c4);border:0;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer}
  .controls button:active{transform:translateY(1px)}

  .back-btn{
    position:fixed;left:20px;top:20px;z-index:10;
    background:linear-gradient(90deg,#b3e5fc,#ffb6c1);
    color:#333;padding:10px 20px;font-weight:700;border:none;
    border-radius:8px;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,.15);
    transition:transform .15s;opacity:0;transition:opacity 1s ease;
  }
  .back-btn:hover{transform:scale(1.05)}
  .back-btn:active{transform:scale(0.97)}

  /* Mute Button */
  .mute-btn{
    position:fixed;right:20px;top:20px;z-index:11;
    background:linear-gradient(90deg,#fad0c4,#ffb6c1);
    color:#333;padding:10px 20px;font-weight:700;border:none;
    border-radius:8px;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,.15);
    transition:transform .15s;opacity:0;transition:opacity 1s ease;
  }
  .mute-btn:hover{transform:scale(1.05)}
  .mute-btn:active{transform:scale(0.97)}

  .ending{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:64px;font-weight:800;color:#fff;text-shadow:0 6px 30px rgba(0,0,0,.25);opacity:0;z-index:12;pointer-events:none;transition:opacity .6s ease}
</style>
</head>
<body>

<div id="intro">Welcome to my journey</div>

<button class="back-btn" id="backBtn" onclick="window.location.href='about.html'">‚Üê Back to About</button>
<button class="mute-btn" id="muteBtn">üîä Mute</button>

<audio id="bgm" src="audio/DavidKBD - Tropical Pack - 01 - Spring Romance - Acoustic.ogg" loop></audio>

<div class="player" id="player">
  <div class="player-box"></div>
  <small>You</small>
</div>

<div class="scene" id="scene">
  <div class="checkpoint"><div class="roof" style="border-bottom-color:#ffb6c1"></div><div class="dialog"><strong>Hospital</strong><br>Born in Jakarta, 28 September 2005.</div></div>
  <div class="checkpoint"><div class="roof" style="border-bottom-color:#ffd6da"></div><div class="dialog"><strong>House</strong><br>Lived in Jakarta until the age of 5, then moved to Palembang and live there till the age of 10.</div></div>
  <div class="checkpoint"><div class="roof" style="border-bottom-color:#ffecb3"></div><div class="dialog"><strong>SDN Dahniar</strong><br>Then move to bandung and spent my current live here.</div></div>
  <div class="checkpoint"><div class="roof" style="border-bottom-color:#b3e5fc"></div><div class="dialog"><strong>SMP Labschool Pulpen</strong><br>Started getting interested in games & self-taught both Unity, and Ren'Py.</div></div>
  <div class="checkpoint"><div class="roof" style="border-bottom-color:#d1c4e9"></div><div class="dialog"><strong>SMK Al-Wafa</strong><br>Learned coding, released a novel & formed Lucky Clover Studio along with my online friends.</div></div>
  <div class="checkpoint"><div class="roof" style="border-bottom-color:#c8e6c9"></div><div class="dialog"><strong>UTB</strong><br>Studied at Universitas Teknologi Bandung. Projects on progress: Jawara Series (novel) & Paper Memory</div></div>
</div>

<div class="ground"></div>
<div class="progress-bar"><div class="progress" id="progress"></div></div>
<div class="controls">
  <button id="leftBtn">‚Üê</button>
  <button id="rightBtn">‚Üí</button>
  <button id="restartBtn">Restart</button>
</div>
<div class="ending" id="ending">What's next?</div>

<script>
const scene=document.getElementById('scene');
const player=document.getElementById('player');
const checkpoints=[...document.querySelectorAll('.checkpoint')];
const progressBar=document.getElementById('progress');
const endingText=document.getElementById('ending');
const bgm=document.getElementById('bgm');
const backBtn=document.getElementById('backBtn');
const muteBtn=document.getElementById('muteBtn');
let playerX=120,sceneLeft=0,moving=false,moveDir=0,baseSpeed=6,reachedTrigger=false,triggerOffset=160,leftBoundaryPlayerX=120;
let maxSceneLeft=-(scene.scrollWidth-window.innerWidth+220);

/* INTRO SEQUENCE */
window.addEventListener('load',()=>{
  const intro=document.getElementById('intro');
  setTimeout(()=>{intro.style.opacity=0;},2500); // fade out
  setTimeout(()=>{
    intro.remove();
    document.querySelectorAll('.scene, .player, .controls, .progress-bar, .back-btn, .mute-btn')
      .forEach(el=>el.style.opacity=1);
    bgm.play().catch(()=>{}); // play music after fadeout
  },3500);
});

/* MUTE BUTTON */
let isMuted=false;
muteBtn.onclick=()=>{
  isMuted=!isMuted;
  bgm.muted=isMuted;
  muteBtn.textContent=isMuted?"üîá Unmute":"üîä Mute";
};

/* ===== CLOUD SYSTEM ===== */
const cloudList=[];
function spawnClouds(){
  for(let i=0;i<5;i++){
    const c=document.createElement('div');
    c.className='cloud';
    const w=110+Math.random()*140;
    c.style.width=w+'px';
    c.style.height=(w/3.6)+'px';
    c.style.top=(6+Math.random()*45)+'%';
    c.style.left=(Math.random()*100)+'vw';
    c.speed=0.05+Math.random()*0.1;
    document.body.appendChild(c);
    cloudList.push(c);
  }
}
spawnClouds();
function updateClouds(){
  cloudList.forEach(c=>{
    let x=parseFloat(c.style.left);
    x+=c.speed;
    if(x>120) x=-20;
    c.style.left=x+'vw';
  });
}

/* ===== DETECTION ===== */
function clamp(v,a,b){return Math.max(a,Math.min(b,v));}
function computeTriggerPoint(){const utb=checkpoints[checkpoints.length-1];const rect=utb.getBoundingClientRect();return rect.left+triggerOffset;}
function detectCollisionsAndTrigger(){
  const pRect=player.getBoundingClientRect();
  checkpoints.forEach(cp=>cp.classList.remove('active'));
  checkpoints.forEach((cp,i)=>{
    const r=cp.getBoundingClientRect();
    const overlap=(pRect.right>r.left+8)&&(pRect.left<r.right-8);
    if(overlap){
      cp.classList.add('active');
      progressBar.style.width=((i+1)/checkpoints.length*100)+'%';
    }
  });
  const triggerX=computeTriggerPoint();
  const pCenterX=(pRect.left+pRect.right)/2;
  if(pCenterX>=triggerX){
    if(!reachedTrigger){
      reachedTrigger=true;
      document.body.style.background='#ffb46e';
      endingText.style.opacity=1;
    }
  }else if(reachedTrigger&&pCenterX<triggerX){
    reachedTrigger=false;
    document.body.style.background='linear-gradient(to bottom,#ffe4ec 0%,#e6f3ff 50%,#ffffff 100%)';
    endingText.style.opacity=0;
  }
}

/* ===== FRAME LOOP ===== */
let lastFrame=performance.now();
function frame(now){
  const dt=Math.min(40,now-lastFrame);
  lastFrame=now;
  if(moving){
    if(moveDir===1&&!reachedTrigger){
      const centerThreshold=window.innerWidth*0.45;
      if(playerX<centerThreshold){playerX=clamp(playerX+baseSpeed,leftBoundaryPlayerX,centerThreshold);}
      else{sceneLeft=clamp(sceneLeft-baseSpeed,maxSceneLeft,0);}
    }else if(moveDir===-1){
      const sceneCanMoveRight=sceneLeft<0;
      if(sceneCanMoveRight){sceneLeft=clamp(sceneLeft+baseSpeed,maxSceneLeft,0);}
      else{playerX=clamp(playerX-baseSpeed,leftBoundaryPlayerX,window.innerWidth*0.5);}
    }
    player.classList.add('walking');
  }else{player.classList.remove('walking');}
  scene.style.left=sceneLeft+'px';
  player.style.left=playerX+'px';
  detectCollisionsAndTrigger();
  updateClouds();
  requestAnimationFrame(frame);
}
requestAnimationFrame(frame);

/* ===== CONTROLS ===== */
document.getElementById('rightBtn').onmousedown=()=>{moving=true;moveDir=1};
document.getElementById('rightBtn').onmouseup=()=>{moving=false};
document.getElementById('leftBtn').onmousedown=()=>{moving=true;moveDir=-1};
document.getElementById('leftBtn').onmouseup=()=>{moving=false};
document.getElementById('restartBtn').onclick=()=>{
  sceneLeft=0;playerX=leftBoundaryPlayerX;moving=false;moveDir=0;reachedTrigger=false;
  document.body.style.background='linear-gradient(to bottom,#ffe4ec 0%,#e6f3ff 50%,#ffffff 100%)';
  endingText.style.opacity=0;progressBar.style.width='0%';
  scene.style.left='0px';player.style.left=playerX+'px';
  checkpoints.forEach(c=>c.classList.remove('active'));
};

/* KEYBOARD: Arrow + A & D */
window.addEventListener('keydown',e=>{
  if(['ArrowRight','d','D'].includes(e.key)){moving=true;moveDir=1}
  if(['ArrowLeft','a','A'].includes(e.key)){moving=true;moveDir=-1}
});
window.addEventListener('keyup',e=>{
  if(['ArrowRight','ArrowLeft','a','A','d','D'].includes(e.key)){moving=false;moveDir=0}
});

/* MOUSE SCROLL (wheel) */
window.addEventListener('wheel',e=>{
  if(e.deltaY>0){moving=true;moveDir=1;setTimeout(()=>moving=false,100);}
  if(e.deltaY<0){moving=true;moveDir=-1;setTimeout(()=>moving=false,100);}
});
</script>
</body>
</html>
